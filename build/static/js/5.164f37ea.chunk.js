(this["webpackJsonpchat-msg"]=this["webpackJsonpchat-msg"]||[]).push([[5],{110:function(e,t,n){"use strict";n.r(t);var c=n(63),a=n(2),i=(n(79),n(17)),s=n(84),r=n.n(s),o=n(85),d=n.n(o),u=n(107),l=n(81),f=n(20),j=(n(80),n(82)),m=n.n(j),b=n(4);var h=function(e){var t=e.text,n=e.fromUser,s=e.time,r=e.refSection,o=e.isSeen,d=Object(i.c)((function(e){return e.user.user&&e.user.user.uid})),u=Object(l.a)(),j=u.ref,h=u.inView,O=Object(a.useState)(o),x=Object(c.a)(O,2),g=x[0],v=x[1];return Object(a.useEffect)((function(){function e(){h&&v(!0),f.b.collection("chat").get().then((function(e){e.forEach((function(e){d===e.data().id_2&&e.data().message===t&&e.data().isSeen===o&&h&&e.ref.update({isSeen:!0})}))}))}return g||e(),function(){return e}}),[h]),Object(b.jsx)("div",{ref:j,className:"chat_msg",style:n?{textAlign:"right"}:{textAlign:"left"},children:Object(b.jsxs)("div",{ref:r,className:"msg",style:n?{borderRadius:"15px 0px 15px 15px",backgroundColor:"#dcf8c6"}:{borderRadius:"0px 15px 15px",backgroundColor:"#fff"},children:[Object(b.jsx)("div",{className:"shap",style:n?{borderLeftColor:"#dcf8c6",right:"-17px"}:{borderRightColor:"#fff",left:"-17px"}}),Object(b.jsx)("span",{className:"text_msg",children:t}),Object(b.jsxs)("div",{className:"time",children:[Object(b.jsx)("span",{className:"show_time",children:s&&"".concat(s.toDate().getDate(),"/").concat(s.toDate().getMonth()+1,"/").concat(s.toDate().getFullYear()," - ").concat(s.toDate().toLocaleTimeString({},{hour12:!0,hour:"numeric",minute:"numeric"}))}),n&&Object(b.jsx)("span",{className:"check_sign",children:Object(b.jsx)(m.a,{style:o?{color:"#4fc3f7"}:{color:"#9AAD8A"}})})]})]})})},O=n(33),x=n(23);var g=function(){var e=Object(i.c)((function(e){return e.chat})),t=Object(i.c)((function(e){return e.user.user&&e.user.user.uid})),n=Object(i.c)((function(e){return e.chat.IsScreenSmallSize})),s=Object(i.c)((function(e){return e.chat.openChat})),o=Object(i.b)(),l=Object(a.useRef)(),j=Object(a.useState)(""),m=Object(c.a)(j,2),g=m[0],v=m[1],p=Object(a.useState)(!1),S=Object(c.a)(p,2),N=S[0],_=S[1],I=Object(a.useState)(""),w=Object(c.a)(I,2),y=w[0],E=w[1];return Object(a.useEffect)((function(){var t=f.b.collection("users").where("uid","==",e.friendInfo.friendId).onSnapshot((function(e){e.forEach((function(e){_(e.data().isOnline),e.data().time&&v("".concat(e.data().time.toDate().getDate(),"/").concat(e.data().time.toDate().getMonth()+1,"/").concat(e.data().time.toDate().getFullYear()," - ").concat(e.data().time.toDate().toLocaleTimeString({},{hour12:!0,hour:"numeric",minute:"numeric"})))}))}),(function(e){return alert(e)}));return l.current&&l.current.scrollIntoView({behavior:"smooth"}),function(){return t()}}),[e.friendInfo.friendId]),Object(a.useEffect)((function(){l.current&&l.current.scrollIntoView({behavior:"smooth"})}),[e.allMessages]),Object(a.useEffect)((function(){var n=f.b.collection("chat").where("id_1","in",[t,e.friendInfo.friendId]).orderBy("timeStamp","asc").onSnapshot((function(n){var c=[];n.forEach((function(n){e.friendInfo.friendId!==n.data().id_1&&e.friendInfo.friendId!==n.data().id_2||t!==n.data().id_1&&t!==n.data().id_2||c.push({message:n.data().message,id_1:n.data().id_1,time:n.data().timeStamp,isSeen:n.data().isSeen})})),o(Object(O.a)(c))}),(function(e){return alert(e)}));return function(){return n()}}),[e.friendInfo.friendId]),Object(b.jsxs)("div",{className:"chat",style:n?s?{zIndex:"5",flexBasis:"100%",display:"block"}:{zIndex:"1",flexBasis:"0%",display:"none"}:{display:"block"},children:[!e.startChat&&Object(b.jsx)("div",{className:"no_msg",children:Object(b.jsxs)("div",{className:"content",children:[Object(b.jsx)("div",{className:"no_msg_image",children:Object(b.jsx)("img",{src:"start_msg.png",alt:"No Message",loading:"lazy"})}),Object(b.jsx)("div",{className:"txt",children:"Start Chatting Now"})]})}),e.startChat&&Object(b.jsxs)("div",{className:"message_section",children:[Object(b.jsxs)("div",{className:"header",children:[Object(b.jsx)("button",{className:"left-arrow",onClick:function(){return n&&o(Object(O.c)(!1))},children:Object(b.jsx)(r.a,{})}),Object(b.jsxs)("div",{className:"user_info",children:[Object(b.jsxs)("div",{className:"text",children:[Object(b.jsx)("h4",{children:e.friendInfo.friendName}),Object(b.jsx)("span",{children:N?"Online":g})]}),Object(b.jsx)("div",{className:"image",children:Object(b.jsx)("img",{src:e.friendInfo.friendImage,alt:e.friendInfo.friendName,loading:"lazy"})})]})]}),Object(b.jsx)("div",{className:"message_content",children:e.allMessages.map((function(e){return Object(b.jsx)(h,{text:e.message,time:e.time,fromUser:e.id_1===t,refSection:l,isSeen:e.isSeen},e.id_1+Math.random())}))}),Object(b.jsx)("div",{className:"send_msg",children:Object(b.jsxs)("form",{onSubmit:function(n){n.preventDefault(),y.trim()&&(f.b.collection("chat").add({id_1:t,id_2:e.friendInfo.friendId,message:y,timeStamp:x.a.firestore.FieldValue.serverTimestamp(),isSeen:!1}).catch((function(e){return alert(e.message)})),E(""))},children:[Object(b.jsx)("div",{className:"text-area",children:Object(b.jsx)(u.a,{"aria-label":"minimum height",minRows:1,maxRows:3,placeholder:"Type a message",onChange:function(e){return function(e){return E(e)}(e.target.value)},value:y,dir:"auto"})}),Object(b.jsx)("button",{type:"submit",className:"send_btn btn",children:Object(b.jsx)(d.a,{})})]})})]})]})};n(86),n(87);var v=function(e){var t=e.image,n=e.isOnline,s=e.name,r=e.clicked,o=e.id,d=Object(a.useState)(""),u=Object(c.a)(d,2),l=u[0],j=u[1],m=Object(a.useState)(0),h=Object(c.a)(m,2),O=h[0],x=h[1],g=Object(i.c)((function(e){return e.user.user.uid})),v=function(){return s.length>16?"".concat(s.slice(0,16),"..."):s},p=["dot",n?"on":"off"];return Object(a.useEffect)((function(){var e=f.b.collection("chat").where("id_1","in",[g,o]).orderBy("timeStamp","asc").onSnapshot((function(e){var t=[];e.forEach((function(e){g!==e.data().id_1&&g!==e.data().id_2||o!==e.data().id_1&&o!==e.data().id_2||t.push(e.data().message)})),j(t)}));return function(){return e()}}),[]),Object(a.useEffect)((function(){var e=f.b.collection("chat").where("id_2","in",[g]).onSnapshot((function(e){var t=[];e.forEach((function(e){g===e.data().id_2&&o===e.data().id_1&&!1===e.data().isSeen&&t.push(!1)})),x(t.length)}));return function(){return e()}}),[]),Object(b.jsxs)("div",{className:"user",onClick:function(){return r({id:o,name:s,image:t})},children:[Object(b.jsxs)("div",{className:"image",children:[Object(b.jsx)("img",{src:t,alt:s,loading:"lazy"}),Object(b.jsx)("span",{className:p.join(" ")})]}),Object(b.jsxs)("div",{className:"text",title:v(),children:[Object(b.jsxs)("div",{className:"header_count",children:[Object(b.jsx)("h6",{children:Object(b.jsx)("bdi",{children:v()})}),O>0&&Object(b.jsx)("div",{className:"msg_counter",children:O})]}),Object(b.jsx)("p",{children:l&&l.length>0&&l[l.length-1].length>20?"".concat(l[l.length-1].slice(0,20),"..."):l[l.length-1]})]})]})};var p=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.user.allUsers})),n=Object(i.c)((function(e){return e.user.user})),c=Object(i.c)((function(e){return e.chat.IsScreenSmallSize})),a=Object(i.c)((function(e){return e.chat.openChat})),s=function(t){e(Object(O.e)(t)),e(Object(O.c)(!0))};return Object(b.jsx)("div",{className:"users",style:c?a?{flexShrink:"0",padding:"0",flexBasis:"0%"}:{flexShrink:"0",flexBasis:"100%"}:null,children:n&&t.length>0?t.map((function(e){var t=e.photoURL,n=e.isOnline,c=e.uid,a=e.name;return Object(b.jsx)(v,{id:c,image:t,isOnline:n,name:a,clicked:s},c)})):Object(b.jsx)("div",{className:"no_users",children:"No Users..."})})};n(88);t.default=function(){var e=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},t=Object(i.b)(),n=Object(i.c)((function(e){return e.chat.IsScreenSmallSize})),s=Object(a.useState)(e()),r=Object(c.a)(s,2),o=r[0],d=r[1];return Object(a.useEffect)((function(){var t=null,n=function(){clearTimeout(t),t=setTimeout((function(){return d(e()<570)}),1e3)};return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}),[]),Object(a.useEffect)((function(){t(Object(O.b)(o))}),[o]),Object(b.jsxs)("div",{className:"main",style:n?{display:"flex"}:null,children:[Object(b.jsx)(p,{}),Object(b.jsx)(g,{})]})}},79:function(e,t,n){},80:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){},88:function(e,t,n){}}]);
//# sourceMappingURL=5.164f37ea.chunk.js.map